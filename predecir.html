<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Predecir</title>
</head>
<body>
    <p id="loader">Entrenando...</p>
    <form action="" method="post" hidden>
        <input type="number" name="input_number">
        <button type="submit">Precedir</button>
    </form>
    <div id="predict"></div>
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs/dist/tf.min.js"></script>
    <script>

        const createModel = () =>{
            //modelo secuencial
            const model = tf.sequential()
            //se agrega una capa
            model.add(tf.layers.dense({units: 1, inputShape: [1]}))

            model.compile({
                loss: "meanSquaredError",
                optimizer: "sgd"
            })

            //valores de x e y
            const xs = tf.tensor2d([-1, 0, 1, 2, 3, 4, 5, 6, 7, 8], [10, 1])
            const ys = tf.tensor2d([-1, 2, 5, 8, 11, 14, 17, 20, 23, 26], [10, 1])

            model.fit(xs, ys, {epochs: 500}).then(()=>{
                const form = document.forms[0]
                const loader = document.getElementById('loader')
                form.hidden = false
                loader.hidden = true

                form.addEventListener("submit", e=>{
                    e.preventDefault()

                    const input = e.target.input_number.value
                    document.getElementById("predict").innerHTML = model.predict(tf.tensor([parseInt(input)], [1, 1]))
                })
            })
        }

        createModel()
        
    </script>
</body>
</html>